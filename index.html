<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jeu de R√©flexe - Classement local</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    #gameZone { margin: 20px auto; border: 2px solid #000; width: 300px; height: 300px; position: relative; background: #f0f0f0; }
    #target { width: 50px; height: 50px; background: red; position: absolute; border-radius: 50%; display: none; cursor: pointer; }
    #leaderboard { margin-top: 40px; }
    .ad-space { margin: 20px 0; padding: 10px; background: #f9f9f9; min-height: 100px; }
  </style>
</head>
<body>
  <h1>‚ö° Jeu de R√©flexe</h1>

  <div class="ad-space">
    <!-- Bloc publicitaire AdSense (en haut de page) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxxxxxxxxxxxx" crossorigin="anonymous"></script>
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-xxxxxxxxxxxxxxxx" data-ad-slot="1111111111" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

  <div>
    <label for="pseudo">Entrez votre pseudo :</label>
    <input type="text" id="pseudo" />
    <button onclick="startGame()">Commencer</button>
  </div>

  <div class="ad-space">
    <!-- Bloc publicitaire AdSense (entre pseudo et jeu) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxxxxxxxxxxxx" crossorigin="anonymous"></script>
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-xxxxxxxxxxxxxxxx" data-ad-slot="2222222222" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

  <div id="gameZone">
    <div id="target"></div>
  </div>

  <h2>Temps de r√©action : <span id="reactionTime">-</span> ms</h2>

  <div class="ad-space">
    <!-- Bloc publicitaire AdSense (entre jeu et classement) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxxxxxxxxxxxx" crossorigin="anonymous"></script>
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-xxxxxxxxxxxxxxxx" data-ad-slot="3333333333" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
  </div>

  <div id="leaderboard">
    <h2>üèÜ Top 100 (C√©l√©brit√©s + Toi)</h2>
    <ol id="scoresList"></ol>
  </div>

  <script>
    const gameZone = document.getElementById('gameZone');
    const target = document.getElementById('target');
    const reactionTimeDisplay = document.getElementById('reactionTime');
    const pseudoInput = document.getElementById('pseudo');

    let startTime = 0;

    // Gestion du meilleur score en localStorage
    function getBestScore() {
      return localStorage.getItem('bestReactionTime')
        ? parseInt(localStorage.getItem('bestReactionTime'), 10)
        : null;
    }

    function saveBestScore(score) {
      localStorage.setItem('bestReactionTime', score.toString());
    }

    const MAX_LEADERBOARD = 100;

    // Liste pr√©d√©finie de c√©l√©brit√©s avec scores (en ms)
    const celebrities = [
      { name: "Michael Schumacher", score: 150 },
      { name: "Lewis Hamilton", score: 140 },
      { name: "Sebastian Vettel", score: 160 },
      { name: "Ayrton Senna", score: 130 },
      { name: "Valentino Rossi", score: 170 },
      { name: "Usain Bolt", score: 120 },
      { name: "Serena Williams", score: 155 },
      { name: "Simone Biles", score: 165 },
      { name: "Tony Hawk", score: 180 },
      { name: "Toi", score: getBestScore() || 9999 },
    ];

    // Affiche le classement dans le HTML
    function displayLeaderboard(leaderboard) {
      const list = document.getElementById('scoresList');
      list.innerHTML = '';

      leaderboard.forEach(entry => {
        const li = document.createElement('li');
        li.textContent = `${entry.name} ‚Äî ${entry.score} ms`;
        list.appendChild(li);
      });
    }

    // Ajoute ou met √† jour ton score, en gardant le meilleur
    function addYourScore(newScore) {
      const bestScore = getBestScore();

      if (bestScore === null || newScore < bestScore) {
        saveBestScore(newScore);
      }

      const effectiveScore = getBestScore();

      let leaderboard = celebrities.filter(c => c.name !== "Toi");
      leaderboard.push({ name: "Toi", score: effectiveScore });

      leaderboard.sort((a, b) => a.score - b.score);

      if (leaderboard.length > MAX_LEADERBOARD) {
        leaderboard = leaderboard.slice(0, MAX_LEADERBOARD);
      }

      displayLeaderboard(leaderboard);
    }

    // D√©marre le jeu
    function startGame() {
      const pseudo = pseudoInput.value.trim();
      if (!pseudo) return alert("Veuillez entrer un pseudo.");

      target.style.display = 'none';
      reactionTimeDisplay.textContent = '-';

      const delay = Math.random() * 3000 + 2000; // 2 √† 5 secondes

      setTimeout(() => {
        const x = Math.random() * (gameZone.clientWidth - 50);
        const y = Math.random() * (gameZone.clientHeight - 50);
        target.style.left = x + 'px';
        target.style.top = y + 'px';
        target.style.backgroundColor = 'green'; // devient vert
        target.style.display = 'block';
        startTime = performance.now();
      }, delay);
    }

    // Quand on clique sur le carr√© vert
    target.addEventListener('click', () => {
      const endTime = performance.now();
      const reaction = Math.round(endTime - startTime);
      reactionTimeDisplay.textContent = reaction + ' ms';
      target.style.display = 'none';

      addYourScore(reaction);
    });

    // Affiche le classement au chargement
    window.onload = () => {
      addYourScore(getBestScore() || 9999);
    };
  </script>
</body>
</html>
